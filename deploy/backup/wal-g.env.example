# WAL-G Environment Configuration for PostgreSQL Backups
# =============================================================================
# Copy this file to wal-g.env and configure for your environment
# =============================================================================

# =============================================================================
# PostgreSQL Connection
# =============================================================================
PGHOST=localhost
PGPORT=5432
PGUSER=prism
PGPASSWORD=CHANGE_ME
PGDATABASE=prism_auth

# =============================================================================
# Storage Backend Configuration
# =============================================================================
# Supported backends: S3, MINIO, FILE, GCS, AZURE

# --- S3/MinIO Configuration ---
WALG_S3_PREFIX=s3://prism-backups/wal-g
AWS_ACCESS_KEY_ID=CHANGE_ME
AWS_SECRET_ACCESS_KEY=CHANGE_ME
AWS_REGION=us-east-1

# For MinIO (S3-compatible)
AWS_ENDPOINT=http://minio:9000
AWS_S3_FORCE_PATH_STYLE=true

# --- File System Configuration (development) ---
# WALG_FILE_PREFIX=/var/lib/prism/backups/wal-g

# =============================================================================
# Compression Settings
# =============================================================================
WALG_COMPRESSION_METHOD=lz4
WALG_DISK_RATE_LIMIT=0
WALG_NETWORK_RATE_LIMIT=0

# =============================================================================
# Retention Policy
# =============================================================================
# Keep this many full backups
WALG_RETENTION_FULL_BACKUP_COUNT=7

# Delete WAL files older than this
WALG_RETENTION_DELETE_BEFORE=FIND_FULL

# =============================================================================
# Encryption (optional)
# =============================================================================
# WALG_PGP_KEY_PATH=/path/to/pgp/key
# WALG_LIBSODIUM_KEY=base64_encoded_key

# =============================================================================
# Performance Tuning
# =============================================================================
WALG_UPLOAD_CONCURRENCY=10
WALG_DOWNLOAD_CONCURRENCY=10
WALG_UPLOAD_DISK_CONCURRENCY=1
WALG_PREFETCH_DIR=/tmp/wal-g-prefetch
WALG_PREVENT_WAL_OVERWRITE=true

# =============================================================================
# Delta Backups
# =============================================================================
WALG_DELTA_MAX_STEPS=6
WALG_DELTA_ORIGIN=LATEST_FULL
